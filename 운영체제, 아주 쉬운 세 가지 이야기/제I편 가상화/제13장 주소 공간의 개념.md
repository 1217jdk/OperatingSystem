# 멀티 프로그래밍과 시분할

- 초기 메모리는 OS가 메모리에 상주하고 하나의 프로그램이 나머지 공간을 차지하는 식으로 구현됨
- 컴퓨터를 사용하는 사용자에 증가에 따라 많은 사용자가 동시에 컴퓨터를 사용하면서 즉각적인 응답을 원하게 됨
- 이에 따라 시분할(time-sharing)을 적용시킨 시스템이 제공되기 시작
- 시분할을 구현하는 방법 중 한 가지 방법으로 다음과 같은 방법이 사용됨
  - 한 프로세스를 아주 짧은 시간 동안 실행
  - 이때 이 프로세스는 모든 메모리에 접근할 수 있음
  - 짧은 시간 동안의 실행이 끝나면 모든 메모리 정보를 디스크에 저장
  - 다른 프로세스에 대해서도 위와 같은 동작을 수행
  - 다시 이전 프로세스를 불러올 때 디스크에 저장했던 메모리 정보를 다시 메모리에 적용시켜서 프로세스를 실행
- 그러나 메모리 전체의 정보를 저장하고 불러오는 과정에서 많은 오버헤드가 발생
- 프로세스를 메모리에 유지하면서 시분할 시스템을 적용시키기 위해 메모리에 일부분만을 프로세스에 할당한 뒤 운영체제가 CPU에서 실행할 프로세스를 선택하는 방식을 사용
- 이처럼 여러 프로그램이 메모리에 존재할 경우 문제가 생길 수 있음

# 주소 공간

- 메모리에 여러 프로그램을 두고 메모리를 사용자가 관리하도록 할 경우 다양한 문제가 발생하기 쉬움
- 운영체제는 사용자가 사용하기 쉬운 메모리 개념인 주소 공간(address space)을 만듦
- 주소 공간은 크게 3가지의 구성 요소로 이루어짐
  - 코드: 명령어들의 집합을 의미하며 주소 공간 최상단에 위치함
  - 스택: 함수 호출 체인 상의 현재 위치, 지역 변수, 함수 인자와 반환 값 등을 저장하는 공간
  - 힙: 동적으로 할당되는 메모리를 위해 사용되는 공간
- 이때 프로그램이 제공 받는 주소는 0부터 시작하지만 이는 실제 물리 주소의 0을 의미하는 것은 아님. 실제로는 특정 물리 주소와 연결되어 있는 가상의 주소
- 이처럼 실제 물리 주소와 가상의 주소를 연결하고 이를 프로그램에 제공하는 것을 보고 메모리를 가상화(virtualizing memory) 한다고 말함
- 일반적으로 프로그램 코드를 통해 출력하는 모든 주소들도 실제 물리 주소가 아닌 가상 주소임

# 메모리 가상화의 목표

- 가상 메모리(VM) 시스템은 크게 3가지의 목표를 가지고 있음
  - 투명성(transparency): 실행 중인 프로그램이 가상 메모리의 존재를 인지하지 못함
  - 효율성(efficiency): 가상화를 위해 시간 및 메모리 자원이 과도하게 사용되면 안됨
  - 보호(protection): 프로세스는 자신의 주소 공간 밖에 있는 자원에 접근할 수 없음

# 요약

- VM 시스템은 프로그램에게 전용 메모리 공간이 있다는 환상을 제공함
- 운영체제는 하드웨어의 도움을 받아서 가상 주소를 물리 주소로 변환함
- 다음 장부터는 이와 관련된 기본 기법부터 고수준 기법까지 알아볼 예정
